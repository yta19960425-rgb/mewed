<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯æ—¥å¾®æŒ‘æˆ°</title>
    <style>
        body {
            background-color: #67b099;
            display: flex;
            justify-content: center;
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
        }
        .æ“ä½œé¢æ¿ {
            background-color: white;
            /* è®“å®ƒåœ¨æ‰‹æ©Ÿä¸Šå¯¬åº¦ 100%ï¼Œä½†åœ¨å¤§è¢å¹•ä¸Šæœ€é«˜ 400px */
            width: 100%;
            max-width: 400px; 
            padding: 25px;
            margin-top: 20px;
            border-radius: 20px;
            box-shadow: 0px 10px 20px rgba(0,0,0,0.1);
            box-sizing: border-box; /* ç¢ºä¿å…§é‚Šè·ä¸æ’é–‹å¯¬åº¦ */
        }
        .è¼¸å…¥å€åŸŸ {
  display: flex;
  justify-content: center; /* è®“å…§å®¹ç½®ä¸­ */
  gap: 5px; /* è¼¸å…¥æ¡†èˆ‡æŒ‰éˆ•ä¹‹é–“çš„å›ºå®šé–“è· */
}

.æ–‡å­—æ¬„ {
  width: 200px; /* è¨­å®šå›ºå®šå¯¬åº¦ï¼Œå°±ä¸æœƒéš¨æ‰‹æ©Ÿè¢å¹•è®Šå‹• */
  flex-grow: 0; /* ç¦æ­¢å®ƒè‡ªå‹•å¡«æ»¿å‰©é¤˜ç©ºé–“ */
  border: none;
  background-color: #F0F4F8;
  padding: 12px 15px;
  outline: none;
  border-radius: 25px 0 0 25px; /* å·¦å´åœ“è§’ */
  font-size: 16px;
}

.æŒ‰éˆ• {
  background-color: #8d9a53;
  border: none;
  color: white;
  padding: 0 20px;
  cursor: pointer;
  border-radius: 0 25px 25px 0; /* å³å´åœ“è§’ */
  font-size: 20px;
}
        .æ¸…å–® {
            list-style-type: none;
            padding: 0;
            margin-top: 20px;
        }
        .æ¸…å–® li {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee; 
        }
        .æ¸…å–® label {
            flex-grow: 1;
            word-break: break-all; /* é˜²æ­¢é•·æ–‡å­—æ’ç ´ç‰ˆé¢ */
        }
        .æ‰“å‹¾æ–¹å¡Š {
            margin-right: 15px;
            width: 18px;
            height: 18px;
        }
        .åƒåœ¾æ¡¶ {
            background: none;
            border: none;
            cursor: pointer;
            opacity: 0.5;
            font-size: 18px;
        }
        .åƒåœ¾æ¡¶:hover {
            opacity: 1;
        }
        /* å·²å®Œæˆé …ç›®çš„æ¨£å¼ */
        .completed label {
            text-decoration: line-through;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="æ“ä½œé¢æ¿">
        <div class="è¼¸å…¥å€åŸŸ">
            <input placeholder="æ–°å¢é …ç›®" class="æ–‡å­—æ¬„">
            <button class="æŒ‰éˆ•">+</button>
        </div>
        <ul class="æ¸…å–®"></ul>
    </div>

    <script>
        const æ–‡å­—æ¬„ = document.querySelector(".æ–‡å­—æ¬„");
        const æ¸…å–® = document.querySelector(".æ¸…å–®");
        const æŒ‰éˆ• = document.querySelector(".æŒ‰éˆ•");

        // 1. åˆå§‹åŒ–ï¼šå¾ LocalStorage è®€å–è³‡æ–™
        document.addEventListener("DOMContentLoaded", è®€å–å„²å­˜);

        function æ–°ä»»å‹™(å…§å®¹, å·²å®Œæˆ = false) {
            if (å…§å®¹ === "") return;

            const ä»»å‹™ = document.createElement("li");
            if (å·²å®Œæˆ) ä»»å‹™.classList.add("completed");

            ä»»å‹™.innerHTML = `
                <input type="checkbox" class="æ‰“å‹¾æ–¹å¡Š" ${å·²å®Œæˆ ? 'checked' : ''}>
                <label>${å…§å®¹}</label>
                <button class="åƒåœ¾æ¡¶">ğŸ—‘ï¸</button>
            `;

            const åƒåœ¾æ¡¶ = ä»»å‹™.querySelector(".åƒåœ¾æ¡¶");
            const æ‰“å‹¾æ–¹å¡Š = ä»»å‹™.querySelector(".æ‰“å‹¾æ–¹å¡Š");

            // åˆªé™¤äº‹ä»¶
            åƒåœ¾æ¡¶.addEventListener("click", function() {
                ä»»å‹™.remove();
                å„²å­˜è³‡æ–™();
            });

            // ç‹€æ…‹åˆ‡æ›äº‹ä»¶
            æ‰“å‹¾æ–¹å¡Š.addEventListener("change", function() {
                if (æ‰“å‹¾æ–¹å¡Š.checked) {
                    ä»»å‹™.classList.add("completed");
                    æ¸…å–®.append(ä»»å‹™); // ç§»åˆ°æœ€å¾Œ
                } else {
                    ä»»å‹™.classList.remove("completed");
                    æ¸…å–®.prepend(ä»»å‹™); // ç§»åˆ°æœ€å‰
                }
                å„²å­˜è³‡æ–™();
            });

            if (å·²å®Œæˆ) {
                æ¸…å–®.append(ä»»å‹™);
            } else {
                æ¸…å–®.prepend(ä»»å‹™);
            }
            
            å„²å­˜è³‡æ–™();
        }

        // é»æ“ŠæŒ‰éˆ•æ–°å¢
        æŒ‰éˆ•.addEventListener("click", () => {
            æ–°ä»»å‹™(æ–‡å­—æ¬„.value);
            æ–‡å­—æ¬„.value = "";
        });

        // æŒ‰ä¸‹ Enter æ–°å¢
        æ–‡å­—æ¬„.addEventListener("keyup", (e) => {
            if (e.key === "Enter") {
                æ–°ä»»å‹™(æ–‡å­—æ¬„.value);
                æ–‡å­—æ¬„.value = "";
            }
        });

        // 2. å„²å­˜å‡½å¼ï¼šå°‡ç›®å‰çš„æ¸…å–®è½‰ç‚º JSON å­˜å…¥ç€è¦½å™¨
        function å„²å­˜è³‡æ–™() {
            const æ‰€æœ‰ä»»å‹™ = [];
            document.querySelectorAll(".æ¸…å–® li").forEach(li => {
                æ‰€æœ‰ä»»å‹™.push({
                    text: li.querySelector("label").innerText,
                    done: li.querySelector(".æ‰“å‹¾æ–¹å¡Š").checked
                });
            });
            localStorage.setItem("myTasks", JSON.stringify(æ‰€æœ‰ä»»å‹™));
        }

        // 3. è®€å–å‡½å¼ï¼šå¾ç€è¦½å™¨æ‹¿å‡ºè³‡æ–™ä¸¦é¡¯ç¤º
        function è®€å–å„²å­˜() {
            const èˆŠè³‡æ–™ = JSON.parse(localStorage.getItem("myTasks") || "[]");
            // æ¸…é™¤ç¾æœ‰åˆ—è¡¨ï¼ˆé¿å…é‡è¤‡ï¼‰
            æ¸…å–®.innerHTML = "";
            èˆŠè³‡æ–™.forEach(item => {
                æ–°ä»»å‹™(item.text, item.done);
            });
        }
    </script>
</body>
</html>
